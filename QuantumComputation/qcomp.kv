#:set cellsize 50
#:set space 5

<WindowManager>:
    id: screen_manager
    screen1: screen1
    Screen1:
        id: screen1
    Screen2:
    
    
    
<CCell>:
    size_hint: None, None
    size: cellsize, cellsize
    pos_hint: {"y":0}
    canvas:
        Color:
            rgba: 0,0,0,1
        Line:
            points: self.x, self.y+self.height/2., self.x+self.width, self.y+self.height/2.
            width: 3
            cap: 'none'
    
    Button:
        opacity: 0.3
        size_hint: None, None
        size: cellsize,cellsize
        pos_hint: {"x":0, "y":0}
        disabled:True
    
    
<CRow>:
    orientation: 'horizontal'
    pos_hint: {"x":0}
    size_hint: None,None
    height: cellsize
        
    
<CGrid>:
    scroll: scroll      
    ScrollView:
        pos: root.pos
        size: root.size
        do_scroll_X: True
        do_scroll_y: True
               
        FloatLayout:
            id: scroll
            size_hint_y: None
            size_hint_x: None
            size: root.width+200, root.height
            pos: root.pos
            
            Button:
                text: "- Col"
                size_hint: (None, None)
                size: cellsize, 0.5*cellsize
                pos_hint: {}
                pos: scroll.right-2*cellsize, scroll.top-30
                on_release: root.remove_col()
                
            Button:
                text: "+ Col"
                size_hint: (None, None)
                size: cellsize, scroll.height-(cellsize*0.5+space*1.5)
                pos_hint: {}
                pos: scroll.right-cellsize, scroll.y
                on_release: root.add_col()



    


<Screen1>:
    name: "Screen1"
    cgrid: cgrid
    circuit: circuit
    gatesgrid: gatesgrid
    problabel: problabel
    plotbox: plotbox
    on_touch_up: self.cgrid.on_touch_up
    
    
    
    FloatLayout:
        
        canvas:
            Color:
                rgba: 0.7,0.7,0.7,1
            Rectangle:
                pos: self.pos
                size: self.size
            Color:
                rgba: 0.3,0.3,0.3,1
            Rectangle:
                pos: (0, self.height/1.087)
                size: (self.width, self.height/12.5)
            
        
#PANEL DE PROBABILITATS         
        FloatLayout: 
            id: panel1
            visible: False
            opacity: 1 if self.visible else 0
            disabled: not self.visible
            canvas:
                Color:
                    rgba: 0.5,0.5,0.5,1
                Rectangle:
                    pos: self.pos
                    size: self.size
                    
                Color:
                    rgba: 0.3,0.3,0.3,1
                Rectangle:
                    pos: self.pos
                    size: (6, self.height)
                    
            pos_hint: {"right":1}
            size_hint: 0.3, 1
                
                    
                
            Button:
                text: "Exit"
                size_hint: (0.8, 0.05)
                pos_hint: {"x":0.1, "y": 0.01}
                on_release:
                    App.get_running_app().stop()
                    
            ScrollView:
                pos_hint: {"x":0.1, "y": 0.5}
                size_hint: (0.8, 0.45)
                do_scroll_X: False
                do_scroll_y: True
            
                Label:
                    id: problabel
                    size_hint: None, None     
                    size: self.texture_size
                    pos_hint: {'x': 0}
                    pos: root.pos
                    
            
            BoxLayout:
                id: plotbox
                
                size_hint: (1, 0.34)
                pos_hint: {"x":0.02, "y": 0.16}
                
            Button:
                text: 'Q sphere'
                size_hint: (0.38, 0.03)
                pos_hint: {"x":0.1, "y": 0.08}
                on_release:
                    root.ShowQSpehre()
            
            Button:
                text: 'BlochSpheres'
                size_hint: (0.38, 0.03)
                pos_hint: {"x":0.52, "y": 0.08}
                on_release:
                    root.ShowBlochSpheres()
            
            Button:
                text: 'Density Matrix'
                size_hint: (0.29, 0.03)
                pos_hint: {"x":0.1, "y": 0.12}
                on_release:
                    root.ShowDensityMatrix()
                    
            Button:
                text: '2D'
                size_hint: (0.08, 0.03)
                pos_hint: {"x":0.4, "y": 0.12}
                on_release:
                    root.ShowDensityMatrix2D()
                    
            Button:
                text: 'Probabilities'
                size_hint: (0.38, 0.03)
                pos_hint: {"x":0.52, "y": 0.12}
                on_release:
                    root.ShowHistogram()
                    
                
                    
        #PANEL DE PORTES         
        FloatLayout: 
            id: panel2
            visible: False
            opacity: 1 if self.visible else 0
            disabled: not self.visible
            canvas:
                Color:
                    rgba: 0.5,0.5,0.5,1
                Rectangle:
                    pos: self.pos
                    size: self.size
                    
                Color:
                    rgba: 0.3,0.3,0.3,1
                Rectangle:
                    pos: (self.width, 0)
                    size: (6, self.height)
                Rectangle:
                    pos: (0, self.height-6)
                    size: (self.width, 6)
                    
            pos_hint: {"left":0, "bottom": 0}
            size_hint: 0.7, 0.3
            
            GatesGrid:
                pos_hint: {"top":0.9}
                pos: 20, 0
                id: gatesgrid
            
        #PANEL DEL CIRCUIT         
        FloatLayout: 
            id: circuit
            pos_hint: {"top":0.92, "left":0}
            size_hint: 1, 0.92
                        
            BoxLayout:
                
                pos_hint: {"top":0.9,"x":0}
                size_hint: 0.95,0.85
                
                
               
                
                CGrid:
                    id: cgrid
                        

            
            
            
                
                
             
        Button:
            text: "Probabilities"
            size_hint: (0.15, 0.06)
            pos_hint: {"x": 0.54, "y":0.93}
            on_release: root.cgrid.resize_panels(panel1.visible, panel2.visible)
            on_release:
                if panel1.visible == False: panel1.visible = True
                elif panel1.visible == True: panel1.visible = False
             
        Button:
            text: "Gates"
            size_hint: (0.1, 0.06)
            pos_hint: {"x": 0.43, "y":0.93}
            on_release: root.cgrid.resize_panels(panel1.visible, panel2.visible)
            on_release:
                if panel2.visible == False: panel2.visible = True
                elif panel2.visible == True: panel2.visible = False
            
        Button:
            text: "TEST2"
            size_hint: (0.1, 0.06)
            pos_hint: {"x": 0.1+0.11*2, "y":0.93-0.07*1}
            on_press: root.cgrid.add_element2(1,1)
            
        Button:
            text: "+ Col"
            size_hint: (0.1, 0.06)
            pos_hint: {"x": 0.1+0.11*0, "y":0.93-0.07*0}
            on_release: root.cgrid.add_col()
                
        Button:
            text: "- Col"
            size_hint: (0.1, 0.06)
            pos_hint: {"x": 0.1+0.11*0, "y":0.93-0.07*1}
            on_release: root.cgrid.remove_col()
            
        Button:
            text: "Refresh"
            size_hint: (0.1, 0.06)
            pos_hint: {"x": 0.1+0.11*2, "y":0.93-0.07*0}
            on_release: root.cgrid.refresh()
            
        Button:
            text: "+ Row"
            size_hint: (0.1, 0.06)
            pos_hint: {"x": 0.1+0.11*1, "y":0.93-0.07*0}
            on_release: root.cgrid.add_row()
            
    
            
                

    
<Screen2>:
    name: "Screen2"
    
    Button:
        text: "Back"
        on_release: 
            app.root.current = "Screen1"