#:import Factory kivy.factory.Factory

<MyScreenManager>:
    StartingScreen:
    GamingScreen:
    IllustratingScreen:

<StartingScreen>:
    name: 'starting'
    
    
    BoxLayout:
    #title, buttons and logo
        orientation: 'vertical'
        padding: [root.width/3,0]
        
        Image:
            id: QM_image_id
            source: 'Images/quanticmeasures-pixel.png'
            allow_stretch: True
            size_hint_y: 1
        
        BoxLayout:
        #buttons
            orientation: 'vertical'
            padding: [self.width/5, 0]
            spacing: self.height/10
            size_hint_y: 2
        
            Button:
                #size_hint_y: 1
                id: s_to_g
                background_color: (0, 0, 0, 1)
                markup: True
                text: '[color=AA3939]GAME[/color]'
                font_name: '8_bit_madness'
                font_size: self.height
                on_press: root.transition_SG()
                canvas.before:
                    Color:
                        rgba: .5, .5, .5, 1
                    Line:
                        width: 2
                        rectangle: self.x, self.y, self.width, self.height
                        
            Button:
                size_hint_y: 1
                id: s_to_g
                background_color: (0, 0, 0, 1)
                markup: True
                text: '[color=7B9F35]DEMOS[/color]'
                font_name: '8_bit_madness'
                font_size: self.height
                on_press: root.transition_SI() 
                canvas.before:
                    Color:
                        rgba: .5, .5, .5, 1
                    Line:
                        width: 2
                        rectangle: self.x, self.y, self.width, self.height
                    
            Button:
                id: info_id
                background_color: (0, 0, 0, 1)
                markup: True
                text: '[color=226666]INFO[/color]'
                font_name: '8_bit_madness'
                font_size: self.height
                on_release: Factory.InfoPopup().open()
                canvas.before:
                    Color:
                        rgba: .5, .5, .5, 1
                    Line:
                        width: 2
                        rectangle: self.x, self.y, self.width, self.height
                        
            Button: 
                id: physics_id
                background_color: (0, 0, 0, 1)
                markup: True
                text: '[color=808080]PHYSICS[/color]'
                font_name: '8_bit_madness'
                font_size: self.height
                on_release: Factory.PhysicsPopup().open()
                canvas.before:
                    Color:
                        rgba: .5, .5, .5, 1
                    Line:
                        width: 2
                        rectangle: self.x, self.y, self.width, self.height
                
        Image:
            id: UB_logo_id
            size_hint_y: 0.75
            source: 'Images/logo_ub-transparente.png'
            size_hint_x: 0.6
            pos_hint: {'center_x': 0.5, 'center_y': 0.75}
            allow_stretch: True
            
<InfoPopup>:
    size_hint: 0.75, 0.75
    separator_color: [34/255., 102/255., 102/255., 1.]
    title_font: '8_bit_madness'
    title: 'INFO'
    title_align: 'center'
    title_size: self.height/10
    title_color: [34/255., 102/255., 102/255., 1.]
    background: 'Images/transparent.png'
    background_color: [0, 0, 0, .8]
    
    intro: intro_id
    gameplot: gameplot_id
    gamele: gamele_id
    
    ScrollView:
    
        BoxLayout:
        #labels with differents parts of the text
            id: textboxlayout_id
            orientation: 'vertical'
            size_hint_y: None
            height: self.minimum_height
            
            Label:
                id: intro_id
                text_size: self.width, None
                size_hint_y: None
                height: self.texture_size[1]
                font_name: '8_bit_madness'
                font_size: root.height/20
                color: (.5, .5, .5, 1)
                markup: True
                    
            Image:
                id: gameplot_id
                source: 'Images/game_screenshot.png'
                size_hint_y: None
                size_hint_x: None
                allow_stretch: True
                border: (root.height/20, 0, root.height/20, 0)
                width: textboxlayout_id.width
                height: intro_id.width/2
                
            Label:
                id: gamele_id
                text_size: self.width, None
                size_hint_y: None
                height: self.texture_size[1]
                font_name: '8_bit_madness'
                font_size: root.height/20
                color: (.5, .5, .5, 1)
                markup: True
                
                
                    
            
<PhysicsPopup>:
    size_hint: 0.75, 0.75
    separator_color: [34/255., 102/255., 102/255., 1.]
    title_font: '8_bit_madness'
    title: 'PHYSICS'
    title_align: 'center'
    title_size: self.height/10
    title_color: [34/255., 102/255., 102/255., 1.]
    background: 'Images/transparent.png'
    background_color: [0, 0, 0, .8]
    
    phypop: phypop_id
    
    ScrollView:
        Label:
            color: (.5, .5, .5, 1)
            id: phypop_id
            markup: True
            font_name: '8_bit_madness'
            font_size: root.height/20
            text_size: self.width, None
            size_hint_y: None
            height: self.texture_size[1]
            
<GamingScreen>: 
    name: 'gaming'
    
    box1: box1_id
    #skip_btn: skip_id
    label_pause: pause_id
    label_lvl: label_lvl_id
    pause_btn: pause_id
    dummy_btn: dummy_id
    g_to_s: g_to_s_id
    g_to_i: g_to_i_id
    joker1: joker1_id
    joker2: joker2_id    
    joker3: joker3_id
       
    BoxLayout: 
        orientation: 'horizontal'
        
        BoxLayout:
        #lives, main plot and buttons
            orientation: 'vertical'
            size_hint_x: 80
            
            Label:
                id: label_lvl_id
                text: 'LEVEL 1'
                font_name: '8_bit_madness'
                font_size: self.height*0.8
                size_hint_y: 0.75
                
            BoxLayout:
            #lives
                orientation: 'horizontal'
                size_hint_y: 0.75
                
                BoxLayout:
                    size_hint_x: 1
                
                Image:
                    id: live1
                    allow_stretch: True
                    
                Image:
                    id: live2
                    allow_stretch: True
                    
                Image:
                    id: live3
                    allow_stretch: True
                    
                Image:
                    id: live4
                    allow_stretch: True
                
                Image:
                    id: live5
                    allow_stretch: True
                    
                Image:
                    id: live6
                    allow_stretch: True
                    
                Image:
                    id: live7
                    allow_stretch: True
                    
                Image:
                    id: live8
                    allow_stretch: True
                    
                Image:
                    id: live9
                    allow_stretch: True
                    
                Image:
                    id: live10
                    allow_stretch: True
                    
                BoxLayout:
                    size_hint_x: 1
                    
                    
            BoxLayout:
            #main plot
                id: box1_id
                size_hint_y: 8
                
            BoxLayout:
            #buttons
                orientation: 'vertical'
                size_hint_y: 1.5
                padding: [self.width/4, 0, self.width/4, self.height/10]
                spacing: self.height/10
                    
                Button:
                    id: pause_id
                    size_hint_y: 1
                    size_hint_x: 0.2
                    pos_hint: {'center_x': 0.5, 'center_y': 0.75}
                    background_color: (0, 0, 0, 1)
                    text: 'PLAY'
                    font_name: '8_bit_madness'
                    font_size: self.width/3
                    on_press: root.pause()
                    canvas.before:
                        Color:
                            rgba: .5, .5, .5, 1
                        Line:
                            width: 2
                            rectangle: self.x, self.y, self.width, self.height
                         
                BoxLayout:
                #jokers and helping
                    orientation: 'horizontal'
                    size_hint_y: 1
                        
                        
                    BoxLayout:
                    #helping
                        orientation: 'vertical'
                        size_hint_x: 1
                        
                        
                        Label:
                            text: 'HELPING'
                            font_name: '8_bit_madness'
                            font_size: self.height
                            
                        ToggleButton:
                            id: dummy_id
                            state: 'normal'
                            size_hint_x: 0.5
                            background_color: (0, 0, 0, 1)
                            pos_hint: {'center_x': 0.5, 'center_y': 0.75}
                            text: 'OFF'
                            font_name: '8_bit_madness'
                            font_size: self.height
                            on_state: 
                                root.dummy_mode()
                            canvas.before:
                                Color:
                                    rgba: .5, .5, .5, 1
                                Line:
                                    width: 2
                                    rectangle: self.x, self.y, self.width, self.height
                        
                    Label:
                        text: 'JOKERS'
                        font_name: '8_bit_madness'
                        font_size: self.height*0.75
                        size_hint_x: 3
                        canvas.before:
                            Color:
                                rgba: .5, .5, .5, 1
                            Line:
                                width: self.height/30
                                rectangle: self.x, self.y, 0, self.height
                                
                    BoxLayout: 
                    #jokers
                        orientation: 'horizontal'
                        size_hint_x: 3
                        spacing: self.height
                                
                        Button:
                            id: joker1_id
                            background_normal: 'Images/joker.png'
                            background_down: 'Images/joker.png'
                            background_disabled_normal: 'Images/joker_disabled.png'
                            border: (0, 0, 0, 0)
                            size_hint_x: None
                            width: self.height
                            on_release: 
                                root.skip_lvl()
                                self.disabled = True
                            
                        Button:
                            id: joker2_id
                            background_normal: 'Images/joker.png'
                            background_down: 'Images/joker.png'
                            background_disabled_normal: 'Images/joker_disabled.png'
                            border: (0, 0, 0, 0)
                            size_hint_x: None
                            width: self.height
                            on_release: 
                                root.skip_lvl()
                                self.disabled = True
                            
                        Button:
                            id: joker3_id
                            background_normal: 'Images/joker.png'
                            background_down: 'Images/joker.png'
                            background_disabled_normal: 'Images/joker_disabled.png'
                            border: (0, 0, 0, 0)
                            size_hint_x: None
                            width: self.height
                            on_release:  
                                root.skip_lvl()
                                self.disabled = True
            
        BoxLayout: 
        #go to demos and starting
            orientation: 'vertical'
            size_hint_x: 3
            padding: [0, self.height/3, 0.25*self.width, self.height/3]
            spacing: 0.25*self.width
            
            Button:
                id: g_to_i_id
                markup: True
                text: '[color=7B9F35]^ DEMOS ^[/color]'
                font_name: '8_bit_madness'
                font_size: self.width*1.5
                background_color: (0, 0, 0, 0)
                on_release:  root.transition_GI()
                canvas.before:
                    PushMatrix
                    Rotate:
                        angle: -90
                        origin: self.center
                canvas.after:
                    PopMatrix
                
            Button:
                id: g_to_s_id
                background_normal: 'Images/home.png'
                background_down: 'Images/home.png'
                background_color: (.5, .5, .5, 1)
                size_hint_y: None
                height: self.width
                border: (0, 0, 0, 0)
                on_release: root.transition_GS()
            
<IllustratingScreen>:
    name: 'illustrating'

    box1: box1_id
    label_vel: change_vel_id
    label_pause: pause_id
    pause_btn: pause_id
    i_to_s: i_to_s_id
    i_to_g: i_to_g_id
    dropdownbtn: dropdownbtn_id
    dropdownlabel: dropdownlabel_id
    
   
    BoxLayout:
        orientation: 'horizontal'
            
        BoxLayout:
        #go to game and starting
            orientation: 'vertical'
            size_hint_x: 3
            padding: [0.25*self.width, self.height/3, 0, self.height/3]
            spacing: 0.25*self.width
        
            Button:
                id: i_to_g_id
                markup: True
                text: '[color=AA3939]^ GAME ^[/color]'
                font_name: '8_bit_madness'
                font_size: self.width*1.5
                background_color: (0, 0, 0, 0)
                on_release:  root.transition_IG()
                canvas.before:
                    PushMatrix
                    Rotate:
                        angle: 90
                        origin: self.center
                canvas.after:
                    PopMatrix
                
                
            Button:
                id: i_to_s_id
                background_normal: 'Images/home.png'
                background_down: 'Images/home.png'
                background_color: (.5, .5, .5, 1)
                size_hint_y: None
                height: self.width
                border: (0, 0, 0, 0)
                on_release: root.transition_IS()
            
            
        BoxLayout:
        #titles, main plot, play and velocity
            orientation: 'vertical'
            size_hint_x: 80
            
            BoxLayout:
            #titles
                orientation: 'horizontal'  
                padding: [self.width/10, self.height/5, self.width/10, 0]
                size_hint_y: 1.5
                
                Button:
                    size_hint_x: 0.1
                    background_normal: 'Images/prev.png'
                    background_down: 'Images/prev.png'
                    background_color: (.5, .5, .5, 1)
                    border: (0, 0, self.width/10, self.width/10)
                    allow_stretch: True
                    on_press: root.skip_lvl(-1)
                
                BoxLayout: 
                    orientation: 'vertical'
                    padding: (5, 5, 5, 5)
                    
                    Label:
                        id: dropdownlabel_id
                        text: root.lvl_titles[0]
                        font_name: '8_bit_madness'
                        size_hint_y: 3
                        font_size: self.width/20
                         
                    Button:
                        id: dropdownbtn_id
                        font_name: '8_bit_madness'
                        background_color: (0, 0, 0, 1)                       
                        font_size: self.height
                        markup: True
                        text: '[color=808080]PRESS TO SELECT DEMO[/color]'
                        size_hint_y: 1
                        on_release: root.illu_dropdown.open(self)
                                    
                Button:
                    size_hint_x: 0.1
                    background_normal: 'Images/next.png'
                    background_down: 'Images/next.png'
                    background_color: (.5, .5, .5, 1)
                    border: (0, self.width/10, self.width/10, 0)
                    allow_stretch: True
                    on_press: root.skip_lvl(1)
                
            BoxLayout:
            #mainp plot
                size_hint_y: 8
                id: box1_id
            
            BoxLayout:
            #play and velocity
                orientation: 'vertical'
                size_hint_y: 1.5
                padding: [self.width/4, 0, self.width/4, self.height/10]
                spacing: self.height/10
                    
                Button:
                    id: pause_id
                    size_hint_x: 0.2
                    pos_hint: {'center_x': 0.5, 'center_y': 0.75}
                    background_color: (0, 0, 0, 1)
                    text: 'PLAY'
                    font_name: '8_bit_madness'
                    font_size: self.width/3
                    on_press: root.pause() 
                    canvas.before:
                        Color:
                            rgba: .5, .5, .5, 1
                        Line:
                            width: 2
                            rectangle: self.x, self.y, self.width, self.height
                    
                BoxLayout:
                #velocity slider
                    Label: 
                        id: change_vel_id
                        text: 'Velocity    16X'
                        font_name: '8_bit_madness'
                        font_size: self.width/9
                        
                    Slider:
                        id: vel_slider_id
                        min: 1
                        max: 30
                        cursor_image:
                        value: 16
                        on_touch_move: 
                            root.plt_vel_factor = self.value
                            change_vel_id.text = 'VELOCITY    ' + str(int(self.value)) + 'X'
                        on_touch_up: 
                            root.plt_vel_factor = self.value
                            change_vel_id.text = 'VELOCITY    ' + str(int(self.value)) + 'X'
                
        
    
    
    
