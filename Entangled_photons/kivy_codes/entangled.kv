
#:import math math
#:import Factory kivy.factory.Factory
#:kivy 1.0.9

<TablePopup>:

    Button:
        size_hint: (0.2,0.1)
        pos_hint: {'x':0, 'y':0}
        text: 'Close'
        on_release: app.root.close()


<entangledscreen>:

    n_label: n_label #MOLT IMPORTANT AIXÒ, SI NO EL PROGRAMA NO SAP DE Q ÉS
    #slider1:slider1
    label_s1:label_s1
    label_s2:label_s2
    table_checkbox:table_checkbox
    knoblay:knoblay
    s_label:s_label
    #I1:I1
    #I2:I2

	orientation: "vertical"
    padding: 20
    spacing: 10
    # Adding image from the system

    BoxLayout:
        orientation: "horizontal"
        Image:
            id: I1
            pos_hint:{'x': 0., 'y':0.}
            source: 'img\pol2.png'

        # Giving the size of image
            size_hint: (0.4,0.4)

            # allow sterching of image
            allow_stretch: True
            canvas.before:
                PushMatrix:
                Rotate:
                    angle: 0
                    origin:self.center
            canvas.after:
                PopMatrix

        Image:
            id:I2
            pos_hint:{'x': 0., 'y':0.}
            source: 'img\pol2.png'

        # Giving the size of image
            size_hint: (0.4,0.4)


            # allow sterching of image
            allow_stretch: True
            canvas.before:
                PushMatrix
                Rotate:
                    angle: 0
                    origin:self.center
            canvas.after:
                PopMatrix

    Widget:
        size_hint: (1, -0.6)
        id: p_rect

    TabbedPanel:
        size_hint: (1, 0.45)
        do_default_tab: False

        TabbedPanelItem: #creem la primera pestanya
        	text: "[b]Quantic\n experiment:[/b]"
        	markup: True

    		BoxLayout:
    			orientation: "horizontal" #el partim en 2 cols grans

    			BoxLayout:
        			orientation:"vertical"
        			Label: 
        				text: "[b]Experiment settings:[/b]"
        				markup: True
        			BoxLayout:
        				orientation: "horizontal"
        				FloatLayout:
        					pos_hint:{'x': 0, 'y':.0}
	        				Label: 
	        					text: "Number of photons:"
	        					markup: True
	        					pos_hint:{'x': .7, 'y':.3}
	        			FloatLayout:
	        				pos_hint:{'x': 0, 'y':.0}
	        				Button:
	        					text:"-"
	        					size_hint: (0.3,0.2)
	        					pos_hint:{'x': 1.2, 'y':.7}
	        					on_release: root.add_photons(-1000)
        				FloatLayout:
        					pos_hint:{'x': 0, 'y':.0}
	        				Label:
	        				    id: n_label
	        					text: "1000"
	        					markup: True
	        					size_hint: (0.3,0.2)
	        					pos_hint:{'x': 0.7, 'y':.7}
        				FloatLayout:
        					pos_hint:{'x': 0, 'y':.0}
	        				Button:
	        					text: "+"
	        					size_hint: (0.3,0.2)
	        					pos_hint:{'x': .2, 'y':.7}
	        					on_release: root.add_photons(1000)

	        		FloatLayout:
                        Label:
                            id: s_label
                            size_hint: None, None
                            size:240,100
                            text:'[font=Digital-7][color=000000][size=34] S=                [/color][/font][/size]'
                            markup:True
                            pos_hint:{'x':0.1,'y':0.2}
                            canvas:
                            canvas.before:
                                Color:
                                    rgba: 0, 153, 0, 0.5

                                RoundedRectangle:
                                    pos: self.pos[0] , self.pos[1]+20
                                    size: (self.width, self.height*0.8)
                                    id: S_rect
        			#BoxLayout:
        				#orientation: "horizontal"
        				#FloatLayout:
        					#pos_hint:{'x': 0, 'y':.0}
		        			#Label:
		        				#pos_hint:{'x': 0.1, 'y':.5}
		        				#text: "Number of repetitions\n of the experiment:"

		        		#FloatLayout:
		        			#TextInput:
		        			    #id:reps
		        				#size_hint: (0.4,.5)
		        				#pos_hint:{'x': 0.3, 'y':.7}
		        				#multiline:False
		        				#on_text_validate:print(reps.text)
	        	BoxLayout:
	        	    id:knoblay
	        		orientation:"vertical"
	        		Label:
	        			text:"[b]Polarizer angles:[/b]"
	        			markup: True
	        		Label:
	        			text: "angle of polarizer 1: \u03B1 (deg)"
	        			pos_hint:{'x': 0, 'y':0}
	        		Knob:
	        		    id: knob1
				        pos_hint:{'x': 0.3, 'y':.7}
                        min: 0
                        max: 360
                        step: 1
                        slope: 1
                        value: 0
                        knobimg_source: "img/knob_metal.png"
                        show_marker: True  # Show surrounding marker
                        marker_img: "img/bline2.png" # Marker texture image

                        Label:
                            id: label_s1
                            text: "{}".format(int(self.parent.value))
                            center: self.parent.center
                            font_size: 20
                            color: 0.1, 0.1, 0.1, 1

				    Label:
	        			text: "angle of polarizer 2: \u03B2 (deg)"
				    Knob:
				        pos_hint:{'x': 0.3, 'y':.7}
                        min: 0
                        max: 360
                        step: 1
                        slope: 1
                        value: 0
                        knobimg_source: "img/knob_metal.png"
                        show_marker: True  # Show surrounding marker
                        marker_img: "img/bline2.png" # Marker texture image
                        #on_touch_up: root.runexp()

                        Label:
                            id: label_s2
                            text: "{}".format(int(self.parent.value))
                            center: self.parent.center
                            font_size: 20
                            color: 0.1, 0.1, 0.1, 1

		        BoxLayout:
		        	orientation:"vertical"
		        	BoxLayout:
			        	orientation: "horizontal"
			        	FloatLayout:
				        	CheckBox:
				        		id: graph
				        		size_hint:(00.1,0.1)
				        		pos_hint:{'x': 0, 'y':0.4}
				        	Label:
				        		text: "Generate graph:\n coincidences vs \u03B2"
				        		pos_hint:{'x': -0.1, 'y':0}
		        	BoxLayout:
			        	orientation: "horizontal"
			        	FloatLayout:
				        	CheckBox:
				        		id: table_checkbox
				        		size_hint:(0.1,0.1)
				        		pos_hint:{'x': 0, 'y':0.4}

				        	Label:
				        		text: "Generate table"
				        		pos_hint:{'x': -0.1, 'y':0}
				    Button:
			        	text: "Run"
			        	id: run_b
			        	on_release: root.runexp()
		        			

        TabbedPanelItem: #creem la 2a pestanya
        	text: "[b]HVT[/b]"
        	markup: True

        TabbedPanelItem:
        	text: "[b]Experiment\n Sketch[/b]"
        	markup: True




